LINK: https://datalemur.com/questions/total-utilization-time

==> My approach:
WITH time_cal AS (
SELECT *
     , CASE WHEN session_status = 'stop' THEN DATE_PART('hour', status_time  - LAG(status_time) OVER (PARTITION BY server_id ORDER BY status_time))
            ELSE NULL
            END AS total_time
FROM server_utilization
ORDER BY server_id DESC,  status_time
)
SELECT SUM(total_time) AS total_uptime_days
FROM time_cal;
