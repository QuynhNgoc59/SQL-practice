LINK: https://leetcode.com/problems/find-books-with-no-available-copies/description/

==> My approach:
-- Calculate number of borrowers per book
WITH BorrowedBooks AS (
    SELECT book_id
         , SUM(CASE WHEN return_date IS NULL THEN 1 ELSE 0 END) AS current_borrowers 
    FROM borrowing_records   
    GROUP BY book_id
)
-- Get books currently having no available copy
SELECT l.book_id 
     , l.title
     , l.author
     , l.genre
     , l.publication_year 
     , b.current_borrowers
FROM BorrowedBooks AS b
JOIN library_books AS l 
    ON b.book_id = l.book_id         
        AND (l.total_copies - b.current_borrowers) = 0 
ORDER BY b.current_borrowers DESC
       , l.title ;


