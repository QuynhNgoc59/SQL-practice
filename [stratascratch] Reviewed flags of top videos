LINK: https://platform.stratascratch.com/coding/2103-reviewed-flags-of-top-videos?code_type=5

==> My approach:
--Calculate user flags per video -> calculate reviewed flags by Youtube per video with flag_id condition

WITH FlagsCount AS (
SELECT TOP 1 WITH TIES video_id
     , DENSE_RANK() OVER (ORDER BY COUNT (DISTINCT flag_id) DESC) AS flags_count_rank
FROM user_flags
GROUP BY video_id
ORDER BY flags_count_rank ASC
)
SELECT video_id
     , COUNT(*) AS Reviewed_flag_count
FROM user_flags AS u 
JOIN flag_review AS f 
    ON u.flag_id = f.flag_id
WHERE u.video_id IN (SELECT video_id FROM FlagsCount)
     AND f.reviewed_by_yt = 'TRUE'
     AND f.flag_id IS NOT NULL
GROUP BY video_id;
