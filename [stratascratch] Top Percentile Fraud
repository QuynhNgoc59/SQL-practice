LINK: https://platform.stratascratch.com/coding/10303-top-percentile-fraud?code_type=5

==> My approach:
WITH percent_rank AS (
    SELECT
        *,
        PERCENT_RANK() OVER (PARTITION BY state ORDER BY fraud_score) AS percent_rank
    FROM fraud_score
)
SELECT
    policy_num,
    state,
    claim_cost,
    fraud_score
FROM percent_rank
WHERE percent_rank >= 0.95
ORDER BY state;
