LINK: https://leetcode.com/problems/analyze-subscription-conversion/?envType=problem-list-v2&envId=21z3vf9h

==> My approach:
WITH Duration AS (
    SELECT user_id 
         , ROUND(AVG(CASE WHEN activity_type = 'free_trial' THEN (activity_duration)*1.0 ELSE NULL END), 2) AS trial_avg_duration 
         , ROUND(AVG(CASE WHEN activity_type = 'paid' THEN (activity_duration)*1.0 ELSE NULL END), 2) AS paid_avg_duration 
    FROM UserActivity
    GROUP BY user_id   
)
SELECT *
FROM Duration
WHERE paid_avg_duration IS NOT NULL
ORDER BY user_id;
