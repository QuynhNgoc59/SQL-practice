LINK: https://leetcode.com/problems/game-play-analysis-iv/description/?envType=problem-list-v2&envId=m8baczxh

==> My approach:
WITH FirstLogin AS (
    SELECT player_id    
         , MIN(event_date) AS first_login
    FROM Activity
    GROUP BY player_id    
)
   , PlayerCount AS (
    SELECT f.player_id
         , COUNT(CASE WHEN DATEDIFF(day, f.first_login, a.event_date) = 1 THEN f.player_id ELSE NULL END) AS returned_player
    FROM FirstLogin AS f
    JOIN Activity AS a
        ON f.player_id = a.player_id    
    GROUP BY f.player_id
   )
SELECT ROUND((SUM(returned_player)*1.0)/ (SELECT COUNT(DISTINCT player_id) FROM Activity), 2) AS fraction 
FROM PlayerCount;
