LINK: https://leetcode.com/problems/most-common-course-pairs/description/

==> My approach:
--Filter users with >= 5 course with avg rating >= 4
WITH Filteredusers AS (
    SELECT user_id      
    FROM course_completions
    GROUP BY user_id      
    HAVING COUNT(*) >= 5
           AND AVG(course_rating) >= 4
)
--Identify consecutive courses per user
, ConsecutiveCourse AS (
    SELECT c.*
         , LEAD(c.course_name) OVER (PARTITION BY c.user_id ORDER BY c.completion_date) AS second_course    
    FROM course_completions AS c 
    JOIN Filteredusers AS f 
        ON c.user_id = f.user_id
)
--Calculate frequency per course pair
SELECT course_name AS first_course    
     , second_course
     , COUNT(*) AS transition_count 
FROM ConsecutiveCourse
WHERE second_course IS NOT NULL
GROUP BY course_name 
       , second_course    
ORDER BY transition_count DESC
       , first_course
       , second_course
